<%- include("../layout/header", { title: "Project list" }); -%>
<% if (notFound) { %> 
	<h1>Project not found</h1>
<% } else { %>
    <h1>Matrix of risks for "<%= project.name %>"</h1>
    <br/>

        <table style=" border-spacing: 0;width: 100%">
            <colgroup>
                <col span="1" style="width: 1%;">
                <col span="1" style="width: 9%;">
                <col span="1" style="width: 18%;">
                <col span="1" style="width: 18%;">
                <col span="1" style="width: 18%;">
                <col span="1" style="width: 18%;">
                <col span="1" style="width: 18%;">
             </colgroup>
        <thead>
          <tr>
            <th class="border-top border-start border-dark"></th>
            <th class="border-end border-top border-dark"  colspan="6" style="text-align:center">probability</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class='rotate p-0 border-dark border-start border-bottom' rowspan="6" style="text-align:center;width: 1%"><strong>impact</strong></td>
            <td class="border-top border-start border-dark p-0" ></td>
            <td class="p-0 border-top border-dark"  style="text-align:center">0 - 20 %</td>
            <td class="p-0 border-top border-dark"  style="text-align:center">20 - 40 %</td>
            <td class="p-0 border-top border-dark"  style="text-align:center">40 - 60 %</td>
            <td class="p-0 border-top border-dark"  style="text-align:center">60 - 80 %</td>
            <td class="p-0 border-top border-dark border-end"  style="text-align:center">80 - 100 %</td>
          </tr>
          <tr>
            <td style="text-align:center" ><span>0 - 20 %</span></td>
            <%
            var i = 0;
            var impact = 0;
            var probability = 0;
            for (var j = 0; j < 4; j++) {
              %> 
              <td class="p-0" >
                <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                  <input type="hidden" name="title" value="Low"/>
                  <input type="hidden" name="minImpact" value="<%=impact %>" />
                  <input type="hidden" name="minProbability" value="<%=probability %>" />
                  <%probability += 20;%> 
                  <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                  <input type="hidden" name="maxProbability" value="<%=probability%>" />  
                  <button type="submit" class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
                </form>
              </td>
            <% }  %>
            <td class="p-0 border-end  border-dark" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Low"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability %>" />
                <button type="submit" class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
              </form>
            </td>
          </tr>
          <%  probability = 0;
                impact += 0.2; %>
          <tr>
            <td style="text-align:center" ><span>20 - 40 %</span></td>
            <td class="p-0">
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Low"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button type="submit" class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
              </form>
            </td>
            <td class="p-0"> 
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Low"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button type="submit" class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
              </form></td>
            <td class="p-0"> 
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Medium"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-medium" style="width:100%">medium <%=matrix[i++] %></button>
              </form></td>
            <td class="p-0">
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Medium"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-medium" style="width:100%">medium <%=matrix[i++] %></button>
              </form></td>
            <td class="p-0 border-end border-dark">
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Medium"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-medium" style="width:100%">medium <%=matrix[i++] %></button>
              </form></td>
          </tr>
          <%  probability = 0;
          impact = 0.4; %>
          <tr>
            <td class="p-0" style="text-align:center" ><span>40 - 60 %</span></td>
            <td class="p-0" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Low"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="0.6" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
              </form></td>
            <td class="p-0" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Medium"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="0.6" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-medium " style="width:100%" >medium <%=matrix[i++] %></button>
              </form>
            </td>
            <td class="p-0" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Medium"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="0.6" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-medium" style="width:100%">medium <%=matrix[i++] %></button>
              </form>
            </td>
            <td class="p-0" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="High"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="0.6" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-high" style="width:100%">high <%=matrix[i++] %></button>
              </form>
            </td>
            <td class="p-0 border-end border-dark" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="High"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="0.6" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-sqr btn-high" style="width:100%">high <%=matrix[i++] %></button>
              </form>
            </td>
          </tr>
          <%  probability = 0;
          impact = 0.6; %>
          <tr>
            <td class="p-0" style="text-align:center"><span>60 - 80%</span></td>
            <td class="p-0" >
              <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
                <input type="hidden" name="title" value="Low"/>
                <input type="hidden" name="minImpact" value="<%=impact %>" />
                <input type="hidden" name="minProbability" value="<%=probability %>" />
                <% probability += 20;%> 
                <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
                <input type="hidden" name="maxProbability" value="<%=probability%>" />
                <button class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
              </form>
              </td>
            <td class="p-0" > <form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="Medium"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-medium" style="width:100%" >medium <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="High"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-high" style="width:100%" >high <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="High"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-high" style="width:100%">high <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0 border-end border-dark" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="Critical"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-critical" style="width:100%">critical <%=matrix[i++] %></button>
            </form></td>
          </tr>
          <%  probability = 0;
          impact = 0.8; %>
          <tr>
            <td class="p-0 border-bottom border-dark" style="text-align:center"><span>80 - 100 %</span></td>
            <td class="p-0 border-bottom border-dark" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="Low"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-low btn-sqr" style="width:100%">low <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0 border-bottom border-dark" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="Medium"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-medium " style="width:100%">medium <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0 border-bottom border-dark" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="High"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-high" style="width:100%" >high <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0 border-bottom border-dark" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="Critical"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-critical" style="width:100%">critical <%=matrix[i++] %></button>
            </form></td>
            <td class="p-0 border-bottom border-dark border-end" ><form class="risk-search-form" method="GET" action=<%="/project/matrix/" + project.id %>>
              <input type="hidden" name="title" value="Dangerous"/>
              <input type="hidden" name="minImpact" value="<%=impact %>" />
              <input type="hidden" name="minProbability" value="<%=probability %>" />
              <% probability += 20;%> 
              <input type="hidden" name="maxImpact" value="<%=impact + 0.2%>" />
              <input type="hidden" name="maxProbability" value="<%=probability%>" />
              <button class="btn btn-outline-secondary btn-sqr btn-dangerous" style="width:100%" >dangerous <%=matrix[i++] %></button>
            </form></td>
          </tr>
        </tbody>
    </table>
    <br/><br/>
    
    <% if( query.minImpact != undefined ) { 
      var mapColorToTitle = {
        Low: "h4-low",
        Medium: "h4-medium",
        High: "h4-high",
        Critical: "h4-critical",
        Dangerous: "h4-dangerous"
      }
      %>
      <h4 class="<%=mapColorToTitle[query.title]%> p-2">Selected Impact: <%= query.minImpact*100 + " - " + query.maxImpact*100 %>% Probability: <%= query.minProbability + " - " + query.maxProbability + "% " + query.title%></h4>

    <%- include("../risk/riskList"); -%> 
    
    <% } %>

<% } %>

<%- include("../layout/footer"); -%> 